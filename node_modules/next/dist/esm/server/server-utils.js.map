{"version":3,"sources":["../../src/server/server-utils.ts"],"names":["format","formatUrl","parse","parseUrl","normalizeLocalePath","getPathMatch","getNamedRouteRegex","getRouteMatcher","matchHas","prepareDestination","removeTrailingSlash","normalizeRscURL","NEXT_INTERCEPTION_MARKER_PREFIX","NEXT_QUERY_PARAM_PREFIX","normalizeVercelUrl","req","trustQuery","paramKeys","pageIsDynamic","defaultRouteRegex","_parsedUrl","url","search","key","Object","keys","query","isNextQueryPrefix","startsWith","isNextInterceptionMarkerPrefix","groups","includes","normalizeNextQueryParam","onKeyNormalized","prefixes","prefix","normalizedKey","substring","length","interpolateDynamicPath","pathname","params","param","optional","repeat","builtParam","paramIdx","indexOf","paramValue","value","Array","isArray","map","v","encodeURIComponent","join","slice","normalizeDynamicRouteParams","ignoreOptional","defaultRouteMatches","hasValidParams","reduce","prev","val","defaultValue","isOptional","isDefaultValue","some","defaultVal","undefined","split","getUtils","page","i18n","basePath","rewrites","trailingSlash","caseSensitive","dynamicRouteMatcher","handleRewrites","parsedUrl","rewriteParams","fsPathname","matchesPage","fsPathnameNoSlash","checkRewrite","rewrite","matcher","source","removeUnnamedParams","strict","sensitive","has","missing","hasParams","assign","parsedDestination","destQuery","appendParamsToQuery","destination","protocol","replace","RegExp","destLocalePathResult","locales","nextInternalLocale","detectedLocale","dynamicParams","beforeFiles","finished","afterFiles","fallback","getParamsFromRouteMatches","renderOpts","routeKeys","re","exec","str","obj","fromEntries","URLSearchParams","matchesHasLocale","routeKeyNames","filterLocaleItem","isCatchAll","_val","item","toLowerCase","locale","splice","every","name","keyName","paramName","pos","parseInt","headers"],"mappings":"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"}