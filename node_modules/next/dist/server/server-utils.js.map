{"version":3,"sources":["../../src/server/server-utils.ts"],"names":["getUtils","interpolateDynamicPath","normalizeDynamicRouteParams","normalizeNextQueryParam","normalizeVercelUrl","req","trustQuery","paramKeys","pageIsDynamic","defaultRouteRegex","_parsedUrl","parseUrl","url","search","key","Object","keys","query","isNextQueryPrefix","NEXT_QUERY_PARAM_PREFIX","startsWith","isNextInterceptionMarkerPrefix","NEXT_INTERCEPTION_MARKER_PREFIX","groups","includes","formatUrl","onKeyNormalized","prefixes","prefix","normalizedKey","substring","length","pathname","params","param","optional","repeat","builtParam","paramIdx","indexOf","paramValue","value","Array","isArray","map","v","encodeURIComponent","join","slice","ignoreOptional","defaultRouteMatches","hasValidParams","reduce","prev","normalizeRscURL","val","defaultValue","isOptional","isDefaultValue","some","defaultVal","undefined","split","page","i18n","basePath","rewrites","trailingSlash","caseSensitive","dynamicRouteMatcher","getNamedRouteRegex","getRouteMatcher","handleRewrites","parsedUrl","rewriteParams","fsPathname","matchesPage","fsPathnameNoSlash","removeTrailingSlash","checkRewrite","rewrite","matcher","getPathMatch","source","removeUnnamedParams","strict","sensitive","has","missing","hasParams","matchHas","assign","parsedDestination","destQuery","prepareDestination","appendParamsToQuery","destination","protocol","replace","RegExp","destLocalePathResult","normalizeLocalePath","locales","nextInternalLocale","detectedLocale","dynamicParams","beforeFiles","finished","afterFiles","fallback","getParamsFromRouteMatches","renderOpts","routeKeys","re","exec","str","obj","fromEntries","URLSearchParams","matchesHasLocale","routeKeyNames","filterLocaleItem","isCatchAll","_val","item","toLowerCase","locale","splice","every","name","keyName","paramName","pos","parseInt","headers"],"mappings":"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"}